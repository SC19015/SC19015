<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19015" />


<title>A-19015-2019-11-29</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A-19015-2019-11-29</h1>
<h4 class="author">19015</h4>
<h4 class="date">2019/12/4</h4>



<div id="questions" class="section level2">
<h2>Questions</h2>
<div id="section" class="section level3">
<h3>9.4</h3>
<ul>
<li>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</li>
</ul>
</div>
</div>
<div id="answers" class="section level2">
<h2>Answers</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">load</span>(<span class="st">&#39;A-19015-2019-11-29.RData&#39;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># lapla &lt;- function(x) 1/2*exp(-abs(x))</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># rw.Metropolis &lt;- function(sigma, x0, N) {</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#   x &lt;- numeric(N)</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#   x[1] &lt;- x0</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#   u &lt;- runif(N)</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#   k &lt;- 0</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#   for (i in 2:N) {</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#     y &lt;- rnorm(1, x[i-1], sigma)</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#     if (u[i] &lt;= (lapla(y) / lapla(x[i-1])))</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#       x[i] &lt;- y else {</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#         x[i] &lt;- x[i-1]</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#         k &lt;- k + 1</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#       }</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#   }</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#   return(list(x=x, k=k))</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># }</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co"># </span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co"># N &lt;- 2000</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co"># sigma &lt;- c(.05, .5,1, 2, 5,16)</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co"># x0 &lt;- 0</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co"># rw1 &lt;- rw.Metropolis(sigma[1], x0, N)</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co"># rw2 &lt;- rw.Metropolis(sigma[2], x0, N)</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co"># rw3 &lt;- rw.Metropolis(sigma[3], x0, N)</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co"># rw4 &lt;- rw.Metropolis(sigma[4], x0, N)</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co"># rw5 &lt;- rw.Metropolis(sigma[5], x0, N)</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co"># rw6 &lt;- rw.Metropolis(sigma[6], x0, N)</span></a></code></pre></div>
<ul>
<li>The acceptance rates of each chain.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k,rw5<span class="op">$</span>k,rw6<span class="op">$</span>k))</a></code></pre></div>
<pre><code>## [1]   45  341  612  955 1399 1811</code></pre>
<ul>
<li>Compare the performances of the chains generated when different variances are used for the proposal distribution.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co">#display 6 graphs together</span></a>
<a class="sourceLine" id="cb4-2" title="2">refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span>),<span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb4-3" title="3">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x,rw5<span class="op">$</span>x,rw6<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">colnames</span>(rw) &lt;-<span class="st"> </span>sigma</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),  <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb4-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb5-3" title="3"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="kw">hist</span>(rw[<span class="dv">501</span><span class="op">:</span>N,j],<span class="dt">probability =</span>  <span class="ot">TRUE</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.55</span>),<span class="dt">breaks =</span> <span class="dv">50</span>,<span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[j]), <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="kw">curve</span>(lapla,<span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb5-6" title="6">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># a &lt;- c(.05, seq(.1, .9, .1), .95)</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># Q &lt;- ifelse(a&lt;0.5,log(2*a),-log(2*(1-a)))</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co"># mc &lt;- rw[501:N, ]</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co"># Qrw &lt;- apply(mc, 2, function(x) quantile(x, a))</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>)) </a></code></pre></div>
<pre><code>##          Q                                          
## 5%  -2.303 -0.941 -2.613 -2.702 -2.205 -2.361 -2.403
## 10% -1.609 -0.788 -2.063 -1.933 -1.451 -1.769 -1.870
## 20% -0.916 -0.458 -1.130 -1.195 -0.845 -1.061 -1.117
## 30% -0.511 -0.274 -0.507 -0.636 -0.504 -0.579 -0.592
## 40% -0.223 -0.039 -0.189 -0.316 -0.193 -0.351 -0.429
## 50%  0.000  0.254  0.038 -0.039  0.059 -0.097 -0.015
## 60%  0.223  0.476  0.252  0.206  0.328  0.095  0.183
## 70%  0.511  0.701  0.509  0.532  0.565  0.421  0.453
## 80%  0.916  0.892  0.915  0.964  1.075  0.864  0.642
## 90%  1.609  1.102  1.499  1.787  1.905  1.494  1.531
## 95%  2.303  1.477  2.084  2.355  2.718  2.404  2.206</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb8-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="kw">plot</span>(Q,Qrw[,j],<span class="dt">main =</span> <span class="st">&quot;Q-Q plots&quot;</span>)</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
