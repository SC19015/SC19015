<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19015" />


<title>A-19015-2019-12-16</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A-19015-2019-12-16</h1>
<h4 class="author">19015</h4>
<h4 class="date">2019/12/11</h4>



<div id="questions" class="section level2">
<h2>Questions</h2>
<div id="section" class="section level3">
<h3>11.1</h3>
<ul>
<li>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(log x) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</li>
</ul>
</div>
<div id="section-1" class="section level3">
<h3>11.5</h3>
<ul>
<li>Write a function to solve the equation <span class="math display">\[ \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1) \Gamma\left(\frac{k-1}{2}\right)}} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u = \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \]</span> for a, where <span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</li>
</ul>
</div>
<div id="a-b-o-blood-type-problem" class="section level3">
<h3>A-B-O blood type problem</h3>
</div>
</div>
<div id="answers" class="section level2">
<h2>Answers</h2>
<div id="section-2" class="section level3">
<h3>11.1</h3>
<ul>
<li>This property does not hold exactly in computer arithmetic, but the identity holds with near equality.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">load</span>(<span class="st">&#39;A-19015-2019-12-06.RData&#39;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">20</span>)) <span class="op">==</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">20</span>))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">20</span>)),<span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">20</span>)))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="section-3" class="section level3">
<h3>11.5</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># gammaratio &lt;- function(k){</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#   if (k %% 2==0) </span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#     return(exp(sum(log((k/2-1):1))-sum(log(seq(1,k-3,2)/2))-log(gamma(1/2))))</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#   else</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#     return(exp(sum(log(seq(1,k-2,2)/2))+log(gamma(1/2))-sum(log(((k-1)/2-1):1))))</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co"># }   </span><span class="al">###</span><span class="co"> Gamma ratio computing for large k</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># g&lt;- function(a,k){</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#   f &lt;- function(x, N) (1 + x^2/N)^(-(N + 1)/2)</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#   I1 &lt;- integrate(f,lower = 0,upper = sqrt(a^2*(k-1)/(k-a^2)),rel.tol=.Machine$double.eps^0.25,N = k-1 )$value</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#   I2 &lt;- integrate(f,lower = 0,upper = sqrt(a^2*k/(k+1-a^2)),rel.tol=.Machine$double.eps^0.25,N = k )$value</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#   return(2*gammaratio(k)*I1/sqrt(k-1)-2*gammaratio(k+1)*I2/sqrt(k))</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co"># }   # the equation in 11.5</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co"># f1 &lt;- function(x,k) pt(sqrt(x^2*(k-1)/(k-x^2)),k-1)-pt(sqrt(x^2*k/(k+1-x^2)),k)</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co"># ##  computing method in 11.4</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co"># a &lt;- seq(0.001,6,0.0001)</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co"># y1 &lt;-numeric(length(a))</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co"># for ( i in 1:length(a)){</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#   y1[i] &lt;- g(a[i],100)</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co"># }</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="kw">plot</span>(<span class="kw">cbind</span>(a,y1),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;a&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;value&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>We can see from the figure there is only one zero point in (0,<span class="math inline">\(\sqrt{k}\)</span>).</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># nk &lt;- c(4:25,100,500,1000)</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># ak &lt;-numeric(25)</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># qk &lt;-numeric(25)</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co"># for (i in 1:25) {</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#   ak[i] &lt;- uniroot(g,c(0.00001,ifelse(nk[i] &lt;=7,sqrt(nk[i])-0.01,2.5)),k=nk[i])$root # the solution of the equation</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#   qk[i] &lt;- uniroot(f1,c(0.00001,ifelse(nk[i] &lt;=7,sqrt(nk[i])-0.01,2.5)),k=nk[i])$root # the solution of 11.4</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co"># }</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="kw">cbind</span>(ak,qk)</a></code></pre></div>
<pre><code>##             ak       qk
##  [1,] 1.492102 1.492102
##  [2,] 1.533534 1.533534
##  [3,] 1.562765 1.562765
##  [4,] 1.584427 1.584427
##  [5,] 1.601199 1.601199
##  [6,] 1.614521 1.614521
##  [7,] 1.625385 1.625385
##  [8,] 1.634409 1.634409
##  [9,] 1.642026 1.642026
## [10,] 1.648511 1.648511
## [11,] 1.654187 1.654187
## [12,] 1.659099 1.659099
## [13,] 1.663433 1.663433
## [14,] 1.667286 1.667286
## [15,] 1.670735 1.670735
## [16,] 1.673840 1.673840
## [17,] 1.676589 1.676589
## [18,] 1.679145 1.679145
## [19,] 1.681471 1.681471
## [20,] 1.683594 1.683594
## [21,] 1.685546 1.685546
## [22,] 1.687347 1.687347
## [23,] 1.720598 1.720598
## [24,] 1.729744 1.729744
## [25,] 1.730895 1.730895</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">plot</span>(<span class="kw">cbind</span>(nk,ak),<span class="dt">xlab =</span> <span class="st">&quot;k&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;A(k)&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">lines</span>(<span class="kw">cbind</span>(nk,ak),<span class="dt">lwd =</span><span class="dv">2</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="a-b-o-blood-type-problem-1" class="section level3">
<h3>A-B-O blood type problem</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># loglike &lt;- function(pq,ng){</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#   p &lt;- pq[1]</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#   q &lt;- pq[2]</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#   r &lt;- 1-p -q</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#   a &lt;- c(p^2,q^2,r^2,2*p*r,2*q*r,2*p*q)</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#   return(-sum(log(a)*ng))</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co"># }</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co"># na &lt;- 28</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co"># nb &lt;- 24</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co"># noo &lt;- 41</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co"># nab &lt;- 70</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co"># n &lt;-na + nb +noo+nab</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co"># eloglike &lt;- function(pq){</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#   p &lt;- pq[1]</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#   q &lt;- pq[2]</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#   r &lt;- 1-p -q</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#   a &lt;- c(p^2+2*p*r,q^2+2*q*r,r^2,2*p*q)</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#   ng &lt;- c(na,nb,noo,nab)</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#   return(-sum(log(a)*ng))</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co"># }</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co"># r &lt;- sqrt(noo/n)</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co"># f2 &lt;- function(x) x^2 +2*x*r - na/n</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co"># p &lt;- uniroot(f2,c(0,1))$root</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co"># q &lt;- 1-p-r</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co"># m &lt;- 200</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co"># pqr &lt;- matrix(rep(0,m*3),nrow = m)</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co"># ll &lt;- numeric(m)</span></a>
<a class="sourceLine" id="cb9-28" title="28"><span class="co"># pqr[1,]&lt;-c(p,q,r)</span></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="co"># for (i in 2:m) {</span></a>
<a class="sourceLine" id="cb9-30" title="30"><span class="co">#   p &lt;- pqr[i-1,1]</span></a>
<a class="sourceLine" id="cb9-31" title="31"><span class="co">#   q &lt;- pqr[i-1,2]</span></a>
<a class="sourceLine" id="cb9-32" title="32"><span class="co">#   r &lt;- pqr[i-1,3]</span></a>
<a class="sourceLine" id="cb9-33" title="33"><span class="co">#   naa &lt;- p/(p+2*r)*na</span></a>
<a class="sourceLine" id="cb9-34" title="34"><span class="co">#   nao &lt;- 2*r/(p+2*r)*na</span></a>
<a class="sourceLine" id="cb9-35" title="35"><span class="co">#   nbb &lt;- q/(q+2*r)*nb</span></a>
<a class="sourceLine" id="cb9-36" title="36"><span class="co">#   nbo &lt;- 2*r/(q+2*r)*nb</span></a>
<a class="sourceLine" id="cb9-37" title="37"><span class="co">#   ng &lt;- c(naa,nbb,noo,nao,nbo,nab)  #estimation step</span></a>
<a class="sourceLine" id="cb9-38" title="38"><span class="co">#   res &lt;- optim(c(p,q),loglike,method=&quot;Nelder-Mead&quot;,ng=ng) #maximum step</span></a>
<a class="sourceLine" id="cb9-39" title="39"><span class="co">#   pqr[i,]&lt;-c(res$par,1-res$par[1]-res$par[2])</span></a>
<a class="sourceLine" id="cb9-40" title="40"><span class="co">#   ll[i] &lt;- -eloglike(res$par)</span></a>
<a class="sourceLine" id="cb9-41" title="41"><span class="co"># }</span></a></code></pre></div>
<ul>
<li>The final results of p,q,r</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">pqr[<span class="dv">200</span>,]</a></code></pre></div>
<pre><code>## [1] 0.3272644 0.3104069 0.3623288</code></pre>
<ul>
<li>Solving the log-likelihood directly.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># res &lt;- optim(c(p,q),eloglike,method=&quot;Nelder-Mead&quot;)</span></a>
<a class="sourceLine" id="cb12-2" title="2">res<span class="op">$</span>par</a></code></pre></div>
<pre><code>## [1] 0.3274290 0.3104228</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">plot</span>(ll[<span class="op">-</span><span class="dv">1</span>],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">abline</span>(<span class="dt">a=</span>ll[<span class="dv">200</span>],<span class="dt">b=</span><span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>According to the figure,the log-maximum likelihood values in M-steps are increasing and converge at last.</li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
